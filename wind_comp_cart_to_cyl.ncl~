load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_code.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/gsn_csm.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/csm/contributed.ncl"
load "$NCARG_ROOT/lib/ncarg/nclscripts/contrib/cd_string.ncl"

; Set the initial start time
start_hour = 0
start_minute = 0
start_second = 0

; Set the increment (in minutes)
increment = 30

; Calculate the number of intervals
num_intervals = 103

; Create the time strings
time_strings = new(num_intervals, string)

do i = 0, num_intervals-1
    ; Format the time string
    hour_str = sprinti("%02d", start_hour)
    minute_str = sprinti("%02d", start_minute)
    second_str = "00"

    time_strings(i) = hour_str + ":" + minute_str + ":" + second_str

    ; Increment the time
    start_minute = start_minute + increment
    if (start_minute .ge. 60) then
        start_minute = start_minute - 60
        start_hour = start_hour + 1
    end if
end do

print(time_strings)

; Initialize a new array to store the new labels
new_labels = new(103, "string")

landfall_index = 65

; Loop through the array
do i=0, num_intervals-1
  if(i .lt. landfall_index) then
    total_minutes_before = (landfall_index - i) * increment
    hours_before = floor(total_minutes_before / 60)
    minutes_before = mod(total_minutes_before, 60)
    new_labels(i) = hours_before + " hours " + minutes_before + " minutes before landfall"
  elseif(i .eq. landfall_index) then
    new_labels(i) = " Landfall Hour"
  else
    total_minutes_after = (i - landfall_index) * increment
    hours_after = floor(total_minutes_after / 60)
    minutes_after = mod(total_minutes_after, 60)
    new_labels(i) = hours_after + " hours " + minutes_after + " minutes after landfall"
  end if
end do

time_strings = new_labels
print(new_labels)
print(time_strings)








do nt = 53,54,1


f        = addfile("boundary_model_b_1.3_landfall.nc","r")
f11      = addfile("diagnostics_temporal.nc","r")
f12      = addfile("boundary_model_b_1.3_landfall_oc.nc","r")
f13      = addfile("diagnostics_temporal.nc","r")
mymod = nt

;;;;;;;;;;;;;;;;;;;;;;;;;;;land;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

u        = f->um(mymod,1,:,:)
v        = f->vm(mymod,1,:,:)
w        = f->wm(mymod,1,:,:)
znot     = f->znot(mymod,:,:)


land_mask = (znot .ne. 0.5)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;Ocean;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;



u_oc        = f12->um(mymod,1,:,:)
v_oc        = f12->vm(mymod,1,:,:)
w_oc        = f12->wm(mymod,1,:,:)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;Land;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


umdt        = f->umdt(mymod,1,:,:)
vmdt        = f->vmdt(mymod,1,:,:)
dudz        = f->dudz(mymod,1,:,:)
dvdz        = f->dvdz(mymod,1,:,:)
px11        = f->pgfx(mymod,:,:)
py11        = f->pgfy(mymod,:,:)
px          = -px11
py          = -py11
vtur_u2d    = f->vtur_u2d(mymod,1,:,:)
vtur_v2d    = f->vtur_v2d(mymod,1,:,:)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


;;;;;;;;;;;;;;;;;;;;;;;;;;;ocean;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


umdt_oc     = f12->umdt(mymod,1,:,:)
vmdt_oc     = f12->vmdt(mymod,1,:,:)
dudz_oc     = f12->dudz(mymod,1,:,:)
dvdz_oc     = f12->dvdz(mymod,1,:,:)
px11_oc     = f12->pgfx(mymod,:,:)
py11_oc     = f12->pgfy(mymod,:,:)
px_oc       = -px11_oc
py_oc       = -py11_oc
vtur_u2d_oc = f12->vtur_u2d(mymod,1,:,:)
vtur_v2d_oc = f12->vtur_v2d(mymod,1,:,:)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

zz = fspan(0,3000,101)

u11      = f->um(mymod,:,:,:)
v11      = f->vm(mymod,:,:,:)


xcen1     = f11->x_center(nt)
ycen1     = f11->y_center(nt)

xcen     = f13->x_center(mymod)
ycen     = f13->y_center(mymod)


lon_cent = f11->x_center(nt)
lat_cent = f11->y_center(nt)

print(xcen+" "+ycen)
print(xcen1+" "+ycen1)

coastline1 = gc_latlon(lat_cent,lon_cent, 30, lon_cent,2,4)
coastline =  coastline1
;coastline2 = sprintf("%0.2f",coastline)
coastline2 = 160.56


X        = f->x
Y        = f->y
pie      = 4.0*atan(1.0)
deg2rad  = pie/180.0
x0    = xcen
y0    = ycen
f0    = x0*deg2rad
l0    = y0*deg2rad
lonstart = -120.0
latstart = 0.0
resol    = 1.0/24.0
rearth   = 6.37122e+06
lats     = new((/1800/),"float")
lons     = new((/2300/),"float")
im       = 2300
jm       = 1800
deltax   = new((/im,jm/),"float")
deltay   = new((/im,jm/),"float")
dxdy    = new((/im,jm/),"float")

r        = new((/im,jm/),"float")
theta    = new((/1802,1802/),"float")
alphaw   = new((/im,jm/),"float")
nx       = 1802
ny       = 1802

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Land;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

u_r      = new((/1802,1802/),"float")
u_r_3d   = new((/101,1802,1802/),"float")
v_t_3d   = new((/101,1802,1802/),"float")
v_t      = new((/1802,1802/),"float")
u_r1     = new((/1802,1802/),"float")
v_t1     = new((/1802,1802/),"float")
dudr     = new((/1802,1802/),"float")
dudr      = new((/ny,nx/),float)
dudtheta  = new((/ny,nx/),float)
dvdr      = new((/ny,nx/),float)
dvdtheta  = new((/ny,nx/),float)
durdr     = new((/ny,nx/),float)
durdtheta = new((/ny,nx/),float)
dvtdr     = new((/ny,nx/),float)
dvtdtheta = new((/ny,nx/),float)
durdz     = new((/ny,nx/),float)
dvtdz     = new((/ny,nx/),float)
dvrdt     = new((/ny,nx/),float)
dvtdt     = new((/ny,nx/),float)
dpdr      = new((/1802,1802/),float)
dpdr2     = new((/1802,1802/),"float")
dpdr3     = new((/1802,1802/),"float")
utur_r    = new((/ny,nx/),float)
vtur_t    = new((/ny,nx/),float)
term4     = new((/ny,nx/),float)

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;Ocean;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

u_r_oc      = new((/1802,1802/),"float")
u_r_3d_oc   = new((/101,1802,1802/),"float")
v_t_3d_oc   = new((/101,1802,1802/),"float")
v_t_oc      = new((/1802,1802/),"float")
u_r1_oc     = new((/1802,1802/),"float")
v_t1_oc     = new((/1802,1802/),"float")
dudr_oc     = new((/1802,1802/),"float")
dudr_oc      = new((/ny,nx/),float)
dudtheta_oc  = new((/ny,nx/),float)
dvdr_oc      = new((/ny,nx/),float)
dvdtheta_oc  = new((/ny,nx/),float)
durdr_oc     = new((/ny,nx/),float)
durdtheta_oc = new((/ny,nx/),float)
dvtdr_oc     = new((/ny,nx/),float)
dvtdtheta_oc = new((/ny,nx/),float)
durdz_oc     = new((/ny,nx/),float)
dvtdz_oc     = new((/ny,nx/),float)
dvrdt_oc     = new((/ny,nx/),float)
dvtdt_oc     = new((/ny,nx/),float)
dpdr_oc      = new((/1802,1802/),float)
dpdr2_oc     = new((/1802,1802/),"float")
dpdr3_oc     = new((/1802,1802/),"float")
utur_r_oc    = new((/ny,nx/),float)
vtur_t_oc    = new((/ny,nx/),float)
term4_oc     = new((/ny,nx/),float)




;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;



dx_interp = new((/1802,1802/),"float")
dy_interp = new((/1802,1802/),"float")
r_interpolated = new((/1802,1802/),"float")
icen     = nx/2 + 1
jcen     = ny/2 + 1
stepx    = 1.0E03
stepy    = 1.0E03
xgrid    = new((/nx/),"float")
ygrid    = new((/ny/),"float")
epsilon  = 1.0e-12  ; small number to avoid division by zero

;;;;;;;;;;;;;;;;;;;;;;;;;;;;smaller grid;;;;;;;;;;;;;;;;;;;;;;;;

nlon        = dimsizes(X)
nlat        = dimsizes(Y)
res_lat        = stepy/(deg2rad*rearth)
res_lon        = stepx/(deg2rad*rearth*cos(lat_cent*deg2rad))
lat_cent_value = abs(lat_cent)
lon_cent_value = abs(lon_cent)


latgrid_center = fspan( (-floor(nlat/2)+1),(floor(nlat/2)), 1802)
latgrid_center = latgrid_center *  res_lat
lat            = latgrid_center+ lat_cent_value
lat            = abs(lat)

longrid_center = fspan( (-floor(nlon/2)+1), floor(nlon/2), 1802)


longrid_center = longrid_center*-1
longrid_center = longrid_center *  res_lon

lon            = longrid_center + lon_cent_value
lon            = abs(lon)
lon            = lon*(-1)
printMinMax(lat,False)
printMinMax(lon,False)



do i=0,nx-1
do j=0,ny-1

f1             = lon(i)*deg2rad
l1             = lat(j)*deg2rad
dx_interp(j,i) = rearth*cos(l0)*(f1-f0)
dy_interp(j,i) = rearth*(l1-l0)
r_interpolated(j,i) = sqrt(dx_interp(j,i)^2+dy_interp(j,i)^2)

end do
end do




do i = 0, nx-1
do j = 0, ny-1

theta(i,j) = atan2(dy_interp(i,j),dx_interp(i,j))

end do
end do


;;;;;;;;;;;;;;;;;;;;;;;;land;;;;;;;;;;;;;;;;;;;;;;;;;

do i = 0, nx-1
do j = 0, ny-1

u_r1(i,j)     = u(i,j)*cos(theta(i,j)) + v(i,j)*sin(theta(i,j))

end do
end do
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


do i = 0, nx-1
do j = 0, ny-1

u_r1_oc(i,j)     = u_oc(i,j)*cos(theta(i,j)) + v_oc(i,j)*sin(theta(i,j))

end do
end do

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

do i = 0, nx-1
do j = 0, ny-1

v_t1(i,j)     = -u(i,j)*sin(theta(i,j)) + v(i,j)*cos(theta(i,j))

end do
end do


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

do i = 0, nx-1
do j = 0, ny-1

v_t1_oc(i,j)     = -u_oc(i,j)*sin(theta(i,j)) + v_oc(i,j)*cos(theta(i,j))

end do
end do

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


r_interpolated@_FillValue = -999

r_inv = 1. / where(r_interpolated.ne.0, r_interpolated, r_interpolated@_FillValue)

cent = v_t1^2*r_inv
cent_oc = v_t1_oc^2*r_inv

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

lonpt = 560-600
latpt = 600-600
lonpt = 600-560
latpt = 600-600


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;


lonpt = 560-600
latpt = 600-600

ws   = sqrt(u_r1^2+v_t1^2)
ws_oc   = sqrt(u_r1_oc^2+v_t1_oc^2)

ws@_FillValue   = -999
u_r1@_FillValue = -999
v_t1@_FillValue = -999


ws_masked = where(land_mask, ws, ws@_FillValue)
u_r1_masked = where(land_mask, u_r1, u_r1@_FillValue)
v_t1_masked = where(land_mask, v_t1, v_t1@_FillValue)



u_r1_DIFF = u_r1 - u_r1_oc
v_t1_DIFF = v_t1 - v_t1_oc
ws_DIFF   = ws - ws_oc


u_r1_DIFF@_FillValue = -999
v_t1_DIFF@_FillValue = -999
ws_DIFF@_FillValue = -999

printMinMax(u_r1_DIFF,False)

u_r1_DIFF_masked = where(land_mask, u_r1_DIFF, u_r1_DIFF@_FillValue)
v_t1_DIFF_masked = where(land_mask, v_t1_DIFF, v_t1_DIFF@_FillValue)
ws_DIFF_masked   = where(land_mask, ws_DIFF, ws_DIFF@_FillValue)


;u_norm = u(:,:) / ws
;v_norm = v(:,:) / ws

;scaling_factor = ws  ; or any other criteria

;u_scaled = u_norm * scaling_factor
;v_scaled = v_norm * scaling_factor


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
nlon        = dimsizes(X)
nlat        = dimsizes(Y)

latgrid_center = fspan( (-floor(nlat/2)+1),(floor(nlat/2)), 1802)
latgrid_center = latgrid_center
lat1           = latgrid_center


longrid_center = fspan( (-floor(nlon/2)+1), floor(nlon/2), 1802)


longrid_center = longrid_center
longrid_center = longrid_center

lon1            = longrid_center


lat1!0        = "lat1"
lat1@units    = "km"
lat1&lat1     = lat1

lon1!0        = "lon1"
lon1@units    = "km"
lon1&lon1     = lon1

w!0        = "lon1"
w!1        = "lat1"
w&lat1     = lat1
w&lon1     = lon1

u_r1!0        = "lon1"
u_r1!1        = "lat1"
u_r1&lat1     = lat1
u_r1&lon1     = lon1

v_t1!0        = "lon1"
v_t1!1        = "lat1"
v_t1&lat1     = lat1
v_t1&lon1     = lon1


u!0        = "lon1"
u!1        = "lat1"
u&lat1     = lat1
u&lon1     = lon1

v!0        = "lon1"
v!1        = "lat1"
v&lat1     = lat1
v&lon1     = lon1


;u_scaled!0        = "lon1"
;u_scaled!1        = "lat1"
;u_scaled&lat1     = lat1
;u_scaled&lon1     = lon1
;v_scaled!0        = "lon1"
;v_scaled!1        = "lat1"
;v_scaled&lat1     = lat1
;v_scaled&lon1     = lon1

ws!0        = "lon1"
ws!1        = "lat1"
ws&lat1     = lat1
ws&lon1     = lon1


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

w_oc!0        = "lon1"
w_oc!1        = "lat1"
w_oc&lat1     = lat1
w_oc&lon1     = lon1



u_r1_oc!0        = "lon1"
u_r1_oc!1        = "lat1"


u_r1_oc&lat1     = lat1
u_r1_oc&lon1     = lon1

v_t1_oc!0        = "lon1"
v_t1_oc!1        = "lat1"
v_t1_oc&lat1     = lat1
v_t1_oc&lon1     = lon1


u_oc!0        = "lon1"
u_oc!1        = "lat1"
u_oc&lat1     = lat1
u_oc&lon1     = lon1
v_oc!0        = "lon1"
v_oc!1        = "lat1"
v_oc&lat1     = lat1
v_oc&lon1     = lon1

ws_oc!0        = "lon1"
ws_oc!1        = "lat1"
ws_oc&lat1     = lat1
ws_oc&lon1     = lon1

ws_DIFF!0        = "lon1"
ws_DIFF!1        = "lat1"
ws_DIFF&lat1     = lat1
ws_DIFF&lon1     = lon1

u_r1_DIFF!0        = "lon1"
u_r1_DIFF!1        = "lat1"
u_r1_DIFF&lat1     = lat1
u_r1_DIFF&lon1     = lon1




u_r1_DIFF_masked!0        = "lon1"
u_r1_DIFF_masked!1        = "lat1"
u_r1_DIFF_masked&lat1     = lat1
u_r1_DIFF_masked&lon1     = lon1

v_t1_DIFF_masked!0        = "lon1"
v_t1_DIFF_masked!1        = "lat1"
v_t1_DIFF_masked&lat1     = lat1
v_t1_DIFF_masked&lon1     = lon1

ws_DIFF_masked!0        = "lon1"
ws_DIFF_masked!1        = "lat1"
ws_DIFF_masked&lat1     = lat1
ws_DIFF_masked&lon1     = lon1


v_t1_DIFF!0        = "lon1"
v_t1_DIFF!1        = "lat1"
v_t1_DIFF&lat1     = lat1
v_t1_DIFF&lon1     = lon1



;;;;;;;;;;;;;;;;;;;;;;;;;;;;


dmin1        = min(u_r1)
dmax1        = max(u_r1)
dmin         = decimalPlaces(dmin1,2,True)
dmax         = decimalPlaces(dmax1,2,True)

dmin2        = min(u_r1_masked)
dmax2        = max(u_r1_masked)

dmin3         = decimalPlaces(dmin2,2,True)
dmax3         = decimalPlaces(dmax2,2,True)


wks = gsn_open_wks("ps","u_r_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = -30
res@cnMaxLevelValF       = 5
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString  = " "
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Radial Wind "
;res@gsnLeftString       = time_strings(nt)
res@gsnRightStringFontHeightF = 0.016
res@gsnCenterStringFontHeightF = 0.012
res@gsnLeftStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF    = 0.016
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.036
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300
res@tmXBLabelsOn  = True
res@tmYLLabelsOn  = True
res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tmXTOn = False
res@tmYROn = False

res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"


plot                            = gsn_csm_contour(wks,u_r1,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = -30.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 5.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 2.5                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False
res1@tmXBLabels = "Distance from Center (km) "
res1@tmXBLabels = "Distance from Center (km) "
res1@tiYAxisString = "Distance from Center (km)"           ; y axis title
res1@tiXAxisString = "Distance from Center (km)"                 ; x axis title

contour_psl = gsn_csm_contour(wks,u_r1,res1)


overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"


  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"
  
  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.93,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)


;tres       =  True
;tres@txFontHeightF = 0.02

;gsn_text(wks,plot,coastline,-60.0,15.0,tres)

  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)


  
lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                   = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)
; Coordinates for the horizontal line

draw(plot)


polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
;  gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers

frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)


dmin1        = min(u_r1_DIFF)
dmax1        = max(u_r1_DIFF)
dmin         = decimalPlaces(dmin1,2,True)
dmax         = decimalPlaces(dmax1,2,True)

dmin2        = min(u_r1_DIFF_masked)
dmax2        = max(u_r1_DIFF_masked)

dmin3         = decimalPlaces(dmin2,2,True)
dmax3         = decimalPlaces(dmax2,2,True)


wks = gsn_open_wks("ps","u_r_DIFF_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = -20
res@cnMaxLevelValF       = 20
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString  = " "
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Radial Wind Difference "
;res@gsnLeftString       = time_strings(nt)
res@gsnRightStringFontHeightF = 0.014
res@gsnCenterStringFontHeightF = 0.012
res@gsnLeftStringFontHeightF = 0.014
res@gsnLeftStringFontHeightF    = 0.014
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.036
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300
res@tmXBLabelsOn  = True
res@tmYLLabelsOn  = True
res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tmXTOn = False
res@tmYROn = False

res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"


plot                            = gsn_csm_contour(wks,u_r1_DIFF,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = -15.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 15.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 1.0                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False
res1@tmXBLabels = "Distance from Center (km) "
res1@tmXBLabels = "Distance from Center (km) "
res1@tiYAxisString = "Distance from Center (km)"           ; y axis title
res1@tiXAxisString = "Distance from Center (km)"                 ; x axis title

contour_psl = gsn_csm_contour(wks,u_r1_DIFF,res1)


overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"
  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"


  gsn_text_ndc(wks, " (g) " + coastline2+" km away from coastline",.32,.95,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)


;tres       =  True
;tres@txFontHeightF = 0.02

;gsn_text(wks,plot,coastline,-60.0,15.0,tres)

  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"



  
lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                   = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)
; Coordinates for the horizontal line

draw(plot)


polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
;  gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,40,0,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,0,40,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,0,-40,polyres)  ; draw polymarkers
;
frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)

dmin1        = min(v_t1_DIFF)
dmax1        = max(v_t1_DIFF)
dmin         = decimalPlaces(dmin1,2,True)
dmax         = decimalPlaces(dmax1,2,True)


dmin2        = min(v_t1_DIFF_masked)
dmax2        = max(v_t1_DIFF_masked)
dmin3         = decimalPlaces(dmin2,2,True)
dmax3         = decimalPlaces(dmax2,2,True)


wks = gsn_open_wks("ps","v_t_DIFF_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = -20
res@cnMaxLevelValF       = 20
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString  = " "
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Tangential Wind Difference "
;res@gsnLeftString       = time_strings(nt)
res@gsnRightStringFontHeightF = 0.014
res@gsnCenterStringFontHeightF = 0.012
res@gsnLeftStringFontHeightF = 0.014
res@gsnLeftStringFontHeightF    = 0.014
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.036
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300
res@tmXBLabelsOn  = True
res@tmYLLabelsOn  = True
res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tmXTOn = False
res@tmYROn = False

res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"


plot                            = gsn_csm_contour(wks,v_t1_DIFF,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = -15.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 15.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 1.0                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False
res1@tmXBLabels = "Distance from Center (km) "
res1@tmXBLabels = "Distance from Center (km) "
res1@tiYAxisString = "Distance from Center (km)"           ; y axis title
res1@tiXAxisString = "Distance from Center (km)"                 ; x axis title

contour_psl = gsn_csm_contour(wks,v_t1_DIFF,res1)


overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

 ; gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)


;tres       =  True
;tres@txFontHeightF = 0.02

;gsn_text(wks,plot,coastline,-60.0,15.0,tres)

  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"
  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)
; gsn_text_ndc(wks, coastline2+" km away from coastline",.32,.97,txres)
  gsn_text_ndc(wks, " (h) " + coastline2+" km away from coastline",.32,.95,txres)

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.97,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)

  
lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                   = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)
; Coordinates for the horizontal line

draw(plot)


polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color


;gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,40,0,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,0,40,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,0,-40,polyres)  ; draw polymarkers
;
frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)

dmin1        = min(ws_DIFF)
dmax1        = max(ws_DIFF)
dmin         = decimalPlaces(dmin1,2,True)
dmax         = decimalPlaces(dmax1,2,True)

dmin2        = min(ws_DIFF_masked)
dmax2        = max(ws_DIFF_masked)
dmin3         = decimalPlaces(dmin2,2,True)
dmax3         = decimalPlaces(dmax2,2,True)


wks = gsn_open_wks("ps","ws_DIFF_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = -20
res@cnMaxLevelValF       = 20
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString  = " "
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Total Wind Difference "
;res@gsnLeftString       = time_strings(nt)
res@gsnRightStringFontHeightF = 0.014
res@gsnCenterStringFontHeightF = 0.012
res@gsnLeftStringFontHeightF = 0.014
res@gsnLeftStringFontHeightF    = 0.014
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.036
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300
res@tmXBLabelsOn  = True
res@tmYLLabelsOn  = True
res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tmXTOn = False
res@tmYROn = False

res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"


plot                            = gsn_csm_contour(wks,ws_DIFF,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = -15.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 15.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 1.0                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False
res1@tmXBLabels = "Distance from Center (km) "
res1@tmXBLabels = "Distance from Center (km) "
res1@tiYAxisString = "Distance from Center (km)"           ; y axis title
res1@tiXAxisString = "Distance from Center (km)"                 ; x axis title

contour_psl = gsn_csm_contour(wks,ws_DIFF,res1)


overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

 ; gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)


;tres       =  True
;tres@txFontHeightF = 0.02

;gsn_text(wks,plot,coastline,-60.0,15.0,tres)

  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"
  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)
; gsn_text_ndc(wks, coastline2+" km away from coastline",.32,.97,txres)
  gsn_text_ndc(wks, " (i) " + coastline2+" km away from coastline",.32,.95,txres)

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.97,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)

  
lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                   = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)
; Coordinates for the horizontal line

draw(plot)


polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
; gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,40,0,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,0,40,polyres)  ; draw polymarkers
;gsn_polymarker(wks,plot,0,-40,polyres)  ; draw polymarkers
;
frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)

dmin1        = min(v_t1)
dmax1        = max(v_t1)
dmin         = decimalPlaces(dmin1,2,True)
dmax         = decimalPlaces(dmax1,2,True)

dmin2        = min(v_t1_masked)
dmax2        = max(v_t1_masked)
dmin3         = decimalPlaces(dmin2,2,True)
dmax3         = decimalPlaces(dmax2,2,True)


wks = gsn_open_wks("ps","v_t_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = 0
res@cnMaxLevelValF       = 50
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"

;  res@gsnRightString = "max = "+dmax+" m/s"
;  res@gsnCenterString     = " Tangential wind (Vt) "
;  res@gsnLeftString       = time_strings(nt)

res@gsnCenterString  = " "
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Tangential Wind  "

res@gsnRightStringFontHeightF = 0.016
res@gsnCenterStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF    = 0.016
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.036
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300
res@tmXTOn = False
res@tmYROn = False

;  res@tiYAxisString = "Distance from Center (km)"           ; y axis title
;  res@tiXAxisString = "Distance from Center (km)"                 ; x axis title

res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.011
res@tiYAxisFontHeightF = 0.011

res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"

plot                            = gsn_csm_contour(wks,v_t1,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = 0.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 50.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 5                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False
res1@tiYAxisString = "Distance from Center (km)"           ; y axis title
res1@tiXAxisString = "Distance from Center (km)"                 ; x axis title

contour_psl = gsn_csm_contour(wks,v_t1,res1)

overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"
  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)
  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.97,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)

lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                  = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)


draw(plot)

polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
;  gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers

frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)


;  gsn_reverse_colormap(wks)
;  gsn_define_colormap(wks,"matlab_jet")

;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;

dmin1        = min(u_r1_oc)
dmax1        = max(u_r1_oc)
dmin         = decimalPlaces(dmin1,4,True)
dmax         = decimalPlaces(dmax1,4,True)


wks = gsn_open_wks("ps","u_r_oc_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXTOn = False
res@tmYROn = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = -30
res@cnMaxLevelValF       = 5
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString  = " "
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Radial Wind (Ocean-only) "

;  res@gsnRightString = "max = "+dmax+" m/s"
;  res@gsnLeftString     = " Radial wind (Vr) "
;  res@gsnLeftString       = time_strings(nt)
res@gsnRightStringFontHeightF = 0.016
res@gsnCenterStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF    = 0.016
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.036
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300

res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"



plot                            = gsn_csm_contour(wks,u_r1_oc,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = -30.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 5.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 2.5                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False

contour_psl = gsn_csm_contour(wks,u_r1_oc,res1)

overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"
  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)
  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.93,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)

lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                  = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

;polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)

draw(plot)


polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
;  gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers

frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)

dmin1        = 0
dmax1        = max(v_t1_oc)
dmin         = decimalPlaces(dmin1,4,True)
dmax         = decimalPlaces(dmax1,4,True)


wks = gsn_open_wks("ps","v_t_oc_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = 0
res@cnMaxLevelValF       = 50
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString  = ""
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Tangential Wind (Ocean-only) "

;  res@gsnRightString = "max = "+dmax+" m/s"
;  res@gsnCenterString     = " Tangential wind (Vt) "
;  res@gsnLeftString       = time_strings(nt)
res@gsnRightStringFontHeightF = 0.016
res@gsnCenterStringFontHeightF = 0.012
res@gsnLeftStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF    = 0.012
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.040
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300
res@tmXTOn = False
res@tmYROn = False


res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"


plot                            = gsn_csm_contour(wks,v_t1_oc,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = 0.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 50.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 5                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False

contour_psl = gsn_csm_contour(wks,v_t1_oc,res1)

overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"
  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)
  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.97,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)

lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                  = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

;polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)


draw(plot)

polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
;  gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers

frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)

delete(res1)


;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;



dmin1        = min(ws)
dmax1        = max(ws)
dmin         = decimalPlaces(dmin1,2,True)
dmax         = decimalPlaces(dmax1,2,True)

dmin2         = min(ws_masked)
dmax2         = max(ws_masked)
dmin3         = decimalPlaces(dmin2,2,True)
dmax3         = decimalPlaces(dmax2,2,True)


wks = gsn_open_wks("ps","ws_land_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.014
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = 0
res@cnMaxLevelValF       = 50
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString  = " "
;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString     = " Total Wind "

;  res@gsnRightString = "max = "+dmax+" m/s"
;  res@gsnCenterString     = " Wind Speed "
;  res@gsnLeftString       = time_strings(nt)
res@gsnRightStringFontHeightF = 0.016
res@gsnCenterStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF    = 0.016
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.040
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300


res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"


plot                            = gsn_csm_contour(wks,ws,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = 0.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 50.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 5                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False

contour_psl = gsn_csm_contour(wks,ws,res1)

threshold = 45
base_thickness = 1.5
thickness_scaled = base_thickness + (ws/threshold) ; This is just an example scaling

vc_glyphs = new(dimsizes(ws), string)

; Assign glyphs based on the threshold
vc_glyphs = where(ws.ge.threshold, "FilledArrow", "LineArrow")



;        thickness_scaled = base_thickness + (ws/40) ; This is just an example scaling

        res_vc = True
        res_vc@gsnDraw                    = False
        res_vc@gsnFrame                   = False
        ;res_vc@vcGlyphStyle               = "LineArrow"
;        res_vc@vcLineArrowThicknessF      = 2.5
;        res_vc@vcLineArrowThicknessF      = thickness_scaled
        res_vc@vcGlyphStyle = vc_glyphs
        res_vc@vcLineArrowThicknessF = thickness_scaled

 ;       res_vc@vcLineArrowThicknessF      = thickness_scaled


        res_vc@vcMinDistanceF             = 0.045
        res_vc@vcRefLengthF               = 0.045
        res_vc@vcRefAnnoOn               = True
;        res_vc@vcRefMagnitudeF           = 45
;        res_vc@vcRefAnnoString1          = "45 ms~S~-1~N~"
        res_vc@vcRefAnnoSide             = "Top"
        res_vc@vcRefAnnoString2On        = False
        res_vc@vcRefAnnoPerimOn          = True
        res_vc@vcRefAnnoOrthogonalPosF   = -0.15
        res_vc@vcRefAnnoParallelPosF     = 0.999
        res_vc@vcRefAnnoBackgroundColor  = "White"
        res_vc@vcVectorDrawOrder         = "PostDraw"

  vector = gsn_csm_vector(wks,u(:,:),v(:,:),res_vc)

;overlay(plot,vector)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)



overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

 ; gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)

overlay(plot,vector)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"
  txres1               = True                      ; text mods desired
  txres1@txFontHeightF = 0.018                     ; text font height
  txres1@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres1@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)
  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.93,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)


lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                  = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)


draw(plot)

polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
;  gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers

frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)
delete(res_vc)



dmin1        = min(ws_oc)
dmax1        = max(ws_oc)
dmin         = decimalPlaces(dmin1,4,True)
dmax         = decimalPlaces(dmax1,4,True)


wks = gsn_open_wks("ps","ws_oc_"+nt)
gsn_define_colormap(wks,"matlab_jet")
;  gsn_reverse_colormap(wks)

res                = True
res@gsnDraw        = False
res@gsnFrame       = False
res@gsnAddCyclic   = False
res@gsnMaximize = True
res@cnFillOn                    = True
res@cnLinesOn                   = False
res@tmXBLabelFontHeightF = 0.016
res@tmYLLabelFontHeightF = 0.016
res@tmXBLabelFont = "times-bold"
res@tmYLLabelFont = "times-bold"
res@cnLevelSelectionMode = "ManualLevels"
res@cnMinLevelValF       = 0
res@cnMaxLevelValF       = 50
res@cnLevelSpacingF      = .25
res@lbBoxLinesOn         = False     ; Turn off labelbar box lines
res@lbLabelsOn           = True
res@lbTitleOn            = False
res@lbOrientation        = "Vertical"
res@lbTitleString        = "m/s" ; bar title
res@lbTitleFont          = "times-bold"
res@lbTitlePosition      = "Right"                           ; title location
res@lbTitleDirection     = "Across"                          ; letter angle
res@lbTitleAngleF        = 90.                               ; title angle
res@lbTitleFontHeightF   = 0.012                              ; font height
res@lbLabelFont  = "times-bold"
res@lbLabelStride = 20
res@lbLabelFontHeightF = 0.016
res@gsnRightString              = "min | max = "+dmin+ " | "+ dmax+" ms~S~-1~N~"
res@gsnCenterString              = " "

;  res@gsnRightString = "max = "+dmax+" m/s"
res@gsnLeftString       = "Total Wind"
res@gsnRightStringFontHeightF = 0.016
res@gsnCenterStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF = 0.016
res@gsnLeftStringFontHeightF    = 0.016
res@cnLineLabelsOn = False
res@cnInfoLabelOn  = False
res@pmLabelBarOrthogonalPosF = -0.036
res@txFont   = "times-bold"
res@pmTickMarkDisplayMode = "Always"
res@trXMinF = -300
res@trXMaxF = 300
res@trYMinF = -300
res@trYMaxF = 300
res@tiYAxisString = "Distance from Center (km)"           ; y axis title
res@tiXAxisString = "Distance from Center (km)"                 ; x axis title
res@tiXAxisFont = "times-bold"
res@tiXAxisFontHeightF = 0.016
res@tiYAxisFontHeightF = 0.016
res@tiYAxisFont = "times-bold"
res@tmXTOn = False
res@tmYROn = False



plot                            = gsn_csm_contour(wks,ws_oc,res)


res1  = True
res1@gsnDraw        = False
res1@gsnFrame       = False
res1@gsnAddCyclic   = False
res1@cnFillOn                    = False
;  res1@cnLinesOn                   = True
res1@cnLineThicknessF               = 4
res1@cnLevelSelectionMode = "ManualLevels"    ; manually set the contour levels with the following 3 resources
res1@cnMinLevelValF  = 0.0                     ; set the minimum contour level
res1@cnMaxLevelValF  = 50.0                    ; set the maximum contour level
res1@cnLevelSpacingF = 5                     ; set the interval between contours
res1@cnLineLabelsOn = True
res1@cnInfoLabelOn  = True
res1@cnLineLabelBackgroundColor = -1
;  res1@gsnContourZeroLineThicknessF = 0            ; eliminates zero contour
res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
;  res1@gsnContourNegLineDashPattern = 1       ; sets negative contours to dash pattern 1
res1@gsnContourPosLineDashPattern = 0
res1@gsnContourZeroLineThicknessF = 0
res1@mpOutlineOn          = False

contour_psl = gsn_csm_contour(wks,ws_oc,res1)

        res_vc = True
        res_vc@gsnDraw                    = False
        res_vc@gsnFrame                   = False
        res_vc@vcGlyphStyle               = "LineArrow"
        res_vc@vcLineArrowThicknessF      = 2.5
        res_vc@vcMinDistanceF             = 0.045
        res_vc@vcRefLengthF               = 0.045
        res_vc@vcRefAnnoOn               = True
        res_vc@vcRefMagnitudeF           = 45
        res_vc@vcRefAnnoString1          = "45 ms~S~-1~N~"
        res_vc@vcRefAnnoSide             = "Top"
        res_vc@vcRefAnnoString2On        = False
        res_vc@vcRefAnnoPerimOn          = True
        res_vc@vcRefAnnoOrthogonalPosF   = -0.15
        res_vc@vcRefAnnoParallelPosF     = 0.999
        res_vc@vcRefAnnoBackgroundColor  = "White"
        res_vc@vcVectorDrawOrder         = "PostDraw"

  vector = gsn_csm_vector(wks,u_oc(:,:),v_oc(:,:),res_vc)

;overlay(plot,vector)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.97,txres)
;  gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)


;overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

 ; gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)

overlay(plot,vector)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

  ;gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)




overlay(plot,contour_psl)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)

overlay(plot,vector)
 
  txres               = True                      ; text mods desired
  txres@txFontHeightF = 0.018                     ; text font height
  txres@txJust        = "CenterLeft"              ; Default is "CenterCenter".
  txres@txFont = "times-bold"

;  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.95,txres)

  gsn_text_ndc(wks,time_strings(nt)+ " ("+coastline2+" km )",.25,.93,txres)
  ;gsn_text_ndc(wks,"min | max = "+dmin3+ " | "+ dmax3+" ms~S~-1~N~",.515,.94,txres1)

lineRes = True

lineRes@gsLineColor = "black"

lineRes@gsLineThicknessF = 2.0 ; adjust for desired thickness



xHorizontal = (/ -300, 300 /) ; or whatever your x-axis limits are

yHorizontal = (/ 0, 0 /)



; Coordinates for the vertical line

xVertical = (/ 0, 0 /)

yVertical = (/ -300, 300 /) ; or whatever your y-axis limits are



; Create and add the lines to the plot

lineHorizontal = gsn_add_polyline(wks, plot, xHorizontal, yHorizontal, lineRes)

lineVertical = gsn_add_polyline(wks, plot, xVertical, yVertical, lineRes)

resp                  = True                      ; polyline mods desired
resp@gsLineColor      = "Black"                     ; color of lines
resp@gsLineThicknessF = 6.0                       ; thickness of lines
;  dum =gsn_add_polyline(wks,plot,600,600,resp)

x_coords = (/ -300, 300 /)
y_coords = (/ coastline, coastline /)

;polyline = gsn_add_polyline(wks, plot, x_coords, y_coords, resp)


draw(plot)

polyres               = True          ; poly marker mods desired
polyres@gsMarkerIndex = 16            ; choose circle as polymarker
;  polyres@gsMarkerSizeF = 12.0           ; select size to avoid streaking
polyres@gsMarkerColor = (/"white"/)   ; choose color
;  gsn_polymarker(wks,plot,lonpt,latpt,polyres)  ; draw polymarkers

frame(wks)
delete(wks)
delete(plot)
delete(contour_psl)


delete(res)
delete(res1)
delete(res_vc)





end do
